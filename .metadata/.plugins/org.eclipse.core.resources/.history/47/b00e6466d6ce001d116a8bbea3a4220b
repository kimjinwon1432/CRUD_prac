<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="CrudSpace">

	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="CrudVO" type="main.service.CrudVO"/>

	<insert id="crudDAO.insertUser">
	
		INSERT INTO userinfo(id, name, phone, email, address, postNum) 
		VALUES (#id#,#name#,#phone#,#email#,#address#,#postNum#)
	</insert>	
	<insert id="crudDAO.insertLogin">
		INSERT INTO logininfo(id, password)
		VALUES (#id#,#password#)
	</insert>
	<insert id="crudDAO.insertAgreement">
		INSERT INTO agreement(id)
		VALUES (#id#)
	</insert>
									<!-- java.lang.Integer -->
	<select id="crudDAO.checkId" resultClass="int">
		select COUNT(*) from userinfo where id=#id#
	</select>
	
	<select id="crudDAO.selectUserInfo" resultClass="egovMap">
		select u.id, 
			u.name, 
			u.phone, 
			(SELECT a.agreedate FROM agreement a WHERE a.id = u.id)
				 as agreedate
		from userinfo u;
	</select>

</sqlMap>